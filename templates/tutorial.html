<html>
    <head> 
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ASL Alphabet Learning</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 20px;
                background-color: #f0f0f0;
            }
            .container {
                max-width: 1200px;
                margin: 0 auto;
                background-color: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 0 10px rgba(0,0,0,0.1);
            }
            .alphabet-buttons {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                margin-bottom: 20px;
            }
            .alphabet-button {
                margin: 5px;
                padding: 10px 15px;
                font-size: 18px;
                cursor: pointer;
                background-color: #4CAF50;
                color: white;
                border: none;
                border-radius: 5px;
                transition: background-color 0.3s;
            }
            .alphabet-button:hover {
                background-color: #45a049;
            }
            .alphabet-button.selected {
                background-color: #D2B48C; /* Light brown */
            }
            .row {
                display: flex;
                margin-bottom: 20px;
            }
            .column {
                flex: 1;
                padding: 10px;
            }
            #webcam, #demo-image {
                width: 100%;
                max-width: 400px;
                height: auto;
                border: 1px solid #ddd;
            }
            .control-button {
                margin-right: 10px;
                padding: 10px 20px;
                font-size: 16px;
                cursor: pointer;
                background-color: #008CBA;
                color: white;
                border: none;
                border-radius: 5px;
                transition: background-color 0.3s;
            }
            .control-button:hover {
                background-color: #007B9A;
            }
            #hand-shape-explanation, #recognition-result, #user-score {
                min-height: 100px;
                border: 1px solid #ddd;
                padding: 10px;
                background-color: #f9f9f9;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="alphabet-buttons">
                <!-- Alphabet buttons will be dynamically added here -->
            </div>
            
            <div class="row">
                <div class="column">
                    <video id="webcam" autoplay playsinline></video>
                </div>
                <div class="column">
                    <img id="demo-image" alt="ASL hand shape demonstration" src="">
                </div>
            </div>
            
            <div class="row">
                <div class="column">
                    <button class="control-button" onclick="startInput()">Input</button>
                    <button class="control-button" onclick="completeAction()">Complete</button>
                </div>
                <div class="column">
                    <div id="hand-shape-explanation"></div>
                </div>
            </div>
            
            <div class="row">
                <div class="column">
                    <div id="recognition-result"></div>
                </div>
                <div class="column">
                    <div id="user-score"></div>
                </div>
            </div>
        </div>

        <script>
            const alphabetLetters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const alphabetButtonsContainer = document.querySelector('.alphabet-buttons');
            const demoImage = document.getElementById('demo-image');
            const webcamVideo = document.getElementById('webcam');
            const handShapeExplanation = document.getElementById('hand-shape-explanation');
            const recognitionResult = document.getElementById('recognition-result');
            const userScore = document.getElementById('user-score');

            let path = window.location.pathname;
            const directoryPath = path.substring(0, path.lastIndexOf("/"));
        
            let currentLetter = '';
            let userName = 'User'; // This should be set by user input or login
            let score = 0;
            let strTemp = '';

            // Initialize alphabet buttons
            alphabetLetters.split('').forEach(letter => {
                const button = document.createElement('button');
                button.className = 'alphabet-button';
                button.textContent = letter;
                button.onclick = () => selectLetter(letter);
                alphabetButtonsContainer.appendChild(button);
            });

            function selectLetter(letter) {
                // Reset all buttons to default color
                document.querySelectorAll('.alphabet-button').forEach(btn => {
                    btn.classList.remove('selected');
                });

                currentLetter = letter;
                
                // Change the color of the selected button to light brown
                const selectedButton = document.querySelector(`.alphabet-button:nth-child(${alphabetLetters.indexOf(letter) + 1})`);
                selectedButton.classList.add('selected');

                // Show ASL hand shape for the selected letter
                strTemp = `./images/${letter.toLowerCase()}.jpg`
        
                demoImage.src = "C:\\Users\\David\\Desktop\\js_try\\images\\a.jpg";
            //  demoImage.src = `.\\images\\${letter.toLowerCase()}.jpg`; // Replace with actual hosted image URL
            //  demoImage.alt = `ASL hand shape for lette ${letter}`;
                demoImage.alt = directoryPath + "/images/a.jpg";  
                handShapeExplanation.textContent = `Demonstrating hand shape for letter ${letter}`;
            }

            async function startWebcam() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    webcamVideo.srcObject = stream;
                } catch (error) {
                    console.error("Error accessing the webcam:", error);
                    handShapeExplanation.textContent = "Error accessing the webcam. Please check your permissions and try again.";
                }
            }

            startWebcam();

            async function startInput() {
                if (!currentLetter) {
                    alert("Please select a letter first!");
                    return;
                }
                
                // Here we would typically start the hand detection process
                // For this example, we'll use a placeholder function
                const detectedLetter = await detectHandShape();
                
                if (detectedLetter === currentLetter) {
                    score += 10;
                    recognitionResult.textContent = `Correct! The detected hand shape matches ${currentLetter}`;
                } else {
                    recognitionResult.textContent = `Incorrect. The detected hand shape does not match ${currentLetter}`;
                }
                
                updateUserScore();
            }

            function completeAction() {
                // Placeholder for the complete action
                alert("Complete action is not yet implemented.");
            }

            async function detectHandShape() {
                // This is a placeholder for the actual hand shape detection
                // In a real implementation, this would use the YOLOv8 model
                return alphabetLetters[Math.floor(Math.random() * alphabetLetters.length)];
            }

            function updateUserScore() {
                userScore.textContent = `${userName}'s current score: ${score}`;
            }

            // Initialize user score
            updateUserScore();

            // Error handling for image loading
            demoImage.onerror = function() {
                console.error("Error loading image:", demoImage.src);
                handShapeExplanation.textContent = `Error loading image. Please try another letter or check your internet connection.`;
            };
        </script>
    </body>
</html>